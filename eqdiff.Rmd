---
title: "Equações em Diferença"
description: |
  Essa aula estuda Equações em Diferença.
author:
  - name: Rafael Peixoto
    affiliation: Universidade Estadual de Campinas
    url: {}
date: 04-19-2021
output:
  distill::distill_article:
    self_contained: false
    toc: true
    highlight: breezedark
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(matlib)
library(tidyverse)
library(limSolve)
library(ggfortify)
```

```{css, echo=FALSE}
d-article p {
  text-align: justify;
  font-size: 16px;
}

d-article p code {
  background: rgba(236, 236, 236, 0.8);
}

d-article div.sourceCode {
  overflow: auto !important;
}
```

## Equações Homogêneas

Queremos analisar a dinâmica resultante de uma equação em diferença de ordem 1, analisando valores diversos para o coeficiente $a_0$:

$$
y_{t+1} + a_0 y_t = 0
$$
Já conhecemos a solução analítica:

$$
y_t = A(-a_0)^t
$$
tal que, para $t = 0$, $A = y_0$, com $y_0$ representando a condição inicial (se conhecida).

#### Criando as séries

Mas também podemos oferecer a solução numérica via simulação, implementando diretamente a equação que define a dinâmica da sequência de valores (a série temporal):

```{r}
### Parâmetros e Condições iniciais

# Coeficiente
a0 <- c(2, -2, 1/3, -1/3, 1, -1)

# Número de iterações
t <- 10

# Valor inicial
y0 <- 0.025
```

```{r}
### Séries temporais geradas a partir de cada coeficiente

# Séries
y1 <- (a0[1])^(1:t) * y0
y2 <- (a0[2])^(1:t) * y0
y3 <- (a0[3])^(1:t) * y0
y4 <- (a0[4])^(1:t) * y0
y5 <- (a0[5])^(1:t) * y0
y6 <- (a0[6])^(1:t) * y0

# Data-Frame (em forma de ts)
df_tsy <- data.frame(y1, y2, y3, y4, y5, y6) %>%
  as.ts()
```

#### Automatizando esse processo

```{r}
ydata <- ts(matrix(NA, nrow = length(1:t), ncol = length(a0)))

for (i in 1:length(a0)) {
  ydata[, i] <- (a0[i])^(1:t) * y0
}
```

```{r}
yfunc <- function(t, a0, y0) {
  
  ydata <- ts(matrix(NA, nrow = length(1:t), ncol = length(a0)))
  
  for (i in 1:length(a0)) {
    ydata[, i] <- (a0[i])^(1:t) * y0
  }
  
  colnames(ydata) <- c(paste0(rep("Y "), 1:ncol(ydata)))
  
  return(ydata)
  
}
```

```{r}
yfunc(t = t, a0 = a0, y0 = y0)
```

#### Plotando

E agora sim, com essa base, partimos para a visualização das séries:

```{r}
ydata <- yfunc(t = t, a0 = a0, y0 = y0)
```

```{r}
autoplot(ydata) +
  ggtitle("Equações de Ordem 1") +
  xlab("t") +
  ylab("Y") +
  theme_hc() +
  theme(plot.title = element_text(size = 15, hjust = 0.5, colour = "black"),
        plot.subtitle = element_text(size = 10, hjust = 0.5, colour = "black"),
        legend.position = "right") +
  scale_colour_discrete("") +
  scale_x_continuous(breaks = seq(from = 0, to = t, by = 1)) +
  scale_y_continuous(breaks = c(0, seq(from = round(min(ydata)), to = round(max(ydata)), by = round(sd(ydata)))))
```













